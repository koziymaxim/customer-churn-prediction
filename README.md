# –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤

## üöÄ –î–µ–º–æ-–≤–µ—Ä—Å–∏—è

**–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ:**

### [‚û°Ô∏è Live Demo on Hugging Face Spaces](https://huggingface.co/spaces/koziymaxim/chicken-segmentation)

---

–¶–µ–ª—å—é –ø—Ä–æ–µ–∫—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ end-to-end ML-—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ç–µ–ª–µ–∫–æ–º-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ ¬´–¢–µ–ª–µ–î–æ–º¬ª. 

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞:**
- **–î–≤–∞ –∫–ª–∞—Å—Å–∞:** –õ–æ—è–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã / –£—à–µ–¥—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (–æ—Ç—Ç–æ–∫).
- **–û–±—ä–µ–º:** ~7,000 –∑–∞–ø–∏—Å–µ–π.
- **–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ—è–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—à–µ–¥—à–∏—Ö.
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** –î–∞–Ω–Ω—ã–µ —Å–æ–±—Ä–∞–Ω—ã –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö —Ç–∞–±–ª–∏—Ü, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—É—Å–ª—É–≥–∞—Ö –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
| –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|---|---|
| **–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö** | `Python`, `Pandas`, `NumPy`, `Matplotlib`, `Seaborn`, `Phik` |
| **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** | `Scikit-learn`, `CatBoost`, `LightGBM` |
| **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏**| `SHAP` |
| **Backend (API)** | `FastAPI`, `Uvicorn` |
| **Frontend (–î–µ–º–æ)** | `Streamlit` |
| **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** | `Docker`, `Hugging Face Spaces`, `Git` |

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)
- **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:** –ß–µ—Ç—ã—Ä–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –µ–¥–∏–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º. –ü—Ä–æ–ø—É—Å–∫–∏ –±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è "Not connected", –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Å–ª—É–≥–∏ —É –∫–ª–∏–µ–Ω—Ç–∞.
- **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:** –í—ã—è–≤–ª–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –ø–æ—Ä—Ç—Ä–µ—Ç —Ç–∏–ø–∏—á–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

### 2. –ò–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –∏ –±–æ—Ä—å–±—ã —Å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
- `days_use`: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å–ª—É–≥–∞–º–∏ (–≤ –¥–Ω—è—Ö).
- `count_services` –∏ `count_streaming`: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –æ—Ç—Ä–∞–∂–∞—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç- –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —É—Å–ª—É–≥.
- –ü—Ä–∏–∑–Ω–∞–∫–∏ —Å –Ω–∏–∑–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏–ª–∏ —Å–∏–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å –¥—Ä—É–≥–∏–º–∏ (`gender`, `total_charges`) –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã.

### 3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
–ë—ã–ª–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π. –ù–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ –±—É—Å—Ç–∏–Ω–≥–∞ **CatBoostClassifier**.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞:**
- **–ü–∞–π–ø–ª–∞–π–Ω—ã:** –í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ Pipeline.
- **–ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é `RandomizedSearchCV`.
- **–ú–µ—Ç—Ä–∏–∫–∞:** –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å `ROC-AUC`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É –∫–ª–∞—Å—Å–æ–≤.

### 4. –ê–Ω–∞–ª–∏–∑ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ **SHAP**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏–ª –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ –∏—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑.

**–ù–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
1.  **`days_use`**: –ß–µ–º –¥–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç —Å –∫–æ–º–ø–∞–Ω–∏–µ–π, —Ç–µ–º –Ω–∏–∂–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞.
2.  **`type`**: –ö–ª–∏–µ–Ω—Ç—ã —Å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ (–Ω–∞ 1-2 –≥–æ–¥–∞) –Ω–∞–∏–±–æ–ª–µ–µ –ª–æ—è–ª—å–Ω—ã.
3.  **`monthly_charges`**: –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å **CatBoostClassifier** –±—ã–ª–∞ –æ—Ü–µ–Ω–µ–Ω–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –∏ –ø–æ–∫–∞–∑–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- **Test ROC-AUC:** **0.926**
- **Test Accuracy:** **92.1%**

**–ê–Ω–∞–ª–∏–∑ –ø–æ –∫–ª–∞—Å—Å–∞–º:**
| –ö–ª–∞—Å—Å | Precision | Recall | F1-Score |
|---|---|---|---|
| –õ–æ—è–ª—å–Ω—ã–µ | 0.92 | 0.99 | 0.95 |
| –û—Ç—Ç–æ–∫ | 0.90 | 0.56 | 0.69 |

**–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫:**

![Confusion Matrix](files/matrix.png)

**–í—ã–≤–æ–¥—ã –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
- –ú–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ –≤—ã—Å–æ–∫–æ–π –æ–±—â–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ ROC-AUC, –ø—Ä–µ–≤—ã—Å–∏–≤ —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ä–æ–≥ 0.88.
- **Recall 99%** –¥–ª—è –∫–ª–∞—Å—Å–∞ "–õ–æ—è–ª—å–Ω—ã–µ" –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–æ—à–∏–±–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
- **Recall 56%** –¥–ª—è –∫–ª–∞—Å—Å–∞ "–û—Ç—Ç–æ–∫" –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç —á—É—Ç—å –±–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å: –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ —Å–Ω–∏–∑–∏—Ç—å –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —á—Ç–æ, –æ–¥–Ω–∞–∫–æ, –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —É–≤–µ–ª–∏—á–µ–Ω–∏—é —á–∏—Å–ª–∞ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (–ª–æ—è–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö –∫–∞–∫ "–≤ –∑–æ–Ω–µ —Ä–∏—Å–∫–∞").



## ‚öôÔ∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

1.  –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω **Docker**.
2.  –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/koziymaxim/customer-churn-prediction.git
    cd customer-churn-prediction
    ```
3.  –°–æ–±–µ—Ä–∏—Ç–µ Docker-–æ–±—Ä–∞–∑:
    ```bash
    docker build -t churn-api .
    ```
4.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å FastAPI-—Å–µ—Ä–≤–∏—Å–æ–º:
    ```bash
    docker run -d -p 8000:8000 --name churn-app churn-api
    ```
5.  API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8000/docs`.
6.  –ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å Streamlit-–¥–µ–º–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):
    ```bash
    pip install -r requirements.txt
    streamlit run app.py
    ```
